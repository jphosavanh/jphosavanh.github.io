[{"name": "app.py", "content": "from shiny import App, Inputs, Outputs, Session, reactive, render, ui\nfrom shiny.types import FileInfo\nimport pandas as pd\nimport os\nimport shutil\nimport numpy as np\nimport re\nfrom faicons import icon_svg\nfrom datetime import datetime\nfrom pathlib import Path\n\nbase_df = pd.DataFrame(columns=['Delete', 'Unit', 'Staff', 'Activity', 'Role', 'Variation', 'Sick leave', 'On-campus', 'Units', 'Paycode', 'Scheduled start time', 'Scheduled start date', 'Scheduled weeks', 'Flex time', 'Unscheduled start date', 'Unscheduled weeks'])\n\ndef get_delete_button(row_index):\n    return ui.HTML(f\"<button rowid={row_index} onclick='Shiny.setInputValue(\\\"remove_row\\\",this.getAttribute(\\\"rowid\\\"))'>Delete</button>\")\n\napp_ui = ui.page_fluid(\n         \n    ui.layout_sidebar(\n        ui.sidebar(\n            ui.input_file(\n                'staff_details', 'Staff details file', accept=['.csv'], multiple=False\n            ),\n            ui.output_ui(\n                'ui_unit'\n            ),\n            ui.output_ui(\n                'ui_staff_list_quick_select'\n            ),\n            ui.output_ui(\n                'ui_staff_list'\n            ),\n            ui.input_select(  \n                'activity',  \n                'Activity',  \n                {   \n                    'Teaching':     {\n                        'tut':          'Tutorial (first)',\n                        'retut':        'Repeat tutorial',\n                        'dem':        'Demonstration',\n                        'lec':          'Lecture (add paycode after)',\n                        'ST CONSULT':\t'Student consultation',\n                        'TEACHING':\t    'Teaching (generic - add paycode after)',\n                    },\n                    'MARKING':\t    'Marking',\n                    'ADMIN':\t    'Admin (emails, student forums, etc)',\n                    'MEETING':\t    'Meeting',\n                    'Other associated teaching': {\n                        'ACAD INTGY':\t'Academic integrity activities',\n                        'NON-C CLIN':\t'Non-contact clinical activities',\n                        'PREP':\t        'Preparation (non-associated working time)',\n                        'PRJ/RS SUP':\t'Project & research supervision',\n                        'REQ ATTNDN':\t'Required attendance',\n                        'ST RECRUIT':\t'Student recruitment',\n                        'TRAINING':\t    'Training',\n                        'TECH SUPPT':\t'Technical support',\n                    },\n                    'Unit development/coordination':{\n                        'COORD DUTY':\t'Subject coordination duties',\n                        'UOSMAT DEV':\t'Unit/material development',\n                    },\n                    'other_activity': 'Other (please specify below)',\n                 },\n                selected=None\n            ),\n            ui.output_ui(\n                'ui_other_activity'\n            ),\n            ui.input_select(  \n                'role',  \n                'Role',  \n                {\n                    'Use prefill': 'Use prefill',\n                    'Tutor': 'Tutor',\n                    'Marker': 'Marker',\n                    'Demonstrator': 'Demonstrator',\n                    'Lecturer': 'Lecturer',\n                    'Coordinator': 'Coordinator',\n                 },\n            ),\n            ui.input_select(  \n                'variation',  \n                'Variation reason',  \n                {\n                    'Additional work': 'Additional work',\n                    'Swap': 'Swap',\n                    'Replacement': 'Replacement',\n                    'other_reason': 'Other (please specify below)'\n                 },\n            ),\n            ui.output_ui(\n                'ui_other_reason'\n            ),\n            ui.input_radio_buttons(  \n                'sick_leave',  \n                'Sick leave?',  \n                {'N': 'No', 'Y': 'Yes'},  \n            ), \n            ui.input_radio_buttons(  \n                'on_campus',  \n                'On campus',  \n                {'Y': 'Yes', 'N': 'No'},  \n            ), \n            ui.input_numeric(  \n                'units',  \n                'Units (hours)',\n                value=0\n            ), \n            ui.input_radio_buttons(  \n                'scheduled',  \n                'Scheduled',  \n                {'Y': 'Yes', 'N': 'No'},  \n            ),\n            ui.output_ui(\n                'ui_scheduled_start_time'\n            ),\n            ui.output_ui(\n                'ui_scheduled_start_date'\n            ),\n            ui.output_ui(\n                'ui_scheduled_weeks'\n            ),\n            ui.output_ui(\n                'ui_flex'\n            ),\n            ui.output_ui(\n                'ui_unscheduled_start_date'\n            ),\n            ui.output_ui(\n                'ui_unscheduled_weeks'\n            ),\n            ui.input_action_button(\n                'add_button', 'Add entries', icon=icon_svg('plus')\n            ),\n        ),\n        ui.output_data_frame('render_df'),\n        ui.download_button('download', 'Download formatted Excel', icon=icon_svg('file-excel')),\n\n        ui.page_fixed(\n            ui.layout_columns(  \n                ui.card(  \n                    ui.card_header('User guide'),\n                    ui.HTML('''<ol>\n  <li>Upload the staff details csv file.</li>\n  <li>Enter the OTA entries on the left and click on Add entries.</li>\n  <li>Make edits in the table if necessary.</li>\n  <li>Download the formatted OTA table.</li>\n</ol> ''')\n                ),  \n                ui.card(  \n                    ui.card_header('Staff details template'),\n                    ui.p('This file should contain all staff member names, their PhD status and role.'),\n                    ui.p('You should name the file such that the first 8 characters are the UoS code.'),\n                    ui.download_button('download_template', 'Download template file', icon=icon_svg('download'))\n                ),  \n            )\n        )\n    )\n)\n\ndef server(input, output, session):\n  \n    @reactive.calc\n    def staff_file():\n        file: list[FileInfo] | None = input.staff_details()\n        if file is None:\n            return None\n        df = pd.read_csv(file[0]['datapath'])\n        # df.columns = ['Name', 'PhDStatus', 'Role']\n        df.set_index('Name', inplace=True)\n        return df    \n    \n    @reactive.calc\n    def guess_code():\n        file: list[FileInfo] | None = input.staff_details()\n        if file is None:\n            return None\n        possible = file[0]['name'][:8]\n        if re.match('[a-zA-Z]{4}[0-9]{4}', possible):\n            return possible.upper()\n        else:\n            return None\n    \n    @render.ui\n    def ui_staff_list_quick_select():\n        if staff_file() is not None:\n            return ui.input_checkbox_group(  \n                'roles_selected',  \n                'Staff (Quick select)',  \n                {  \n                    i: i for i in staff_file()['Role'].unique()\n                } | {'Unselect all' : 'Unselect all'},\n            ),\n    \n    @render.ui\n    @reactive.event(input.roles_selected, ignore_none=False)\n    def ui_staff_list():\n        if staff_file() is not None:\n            selected = [i for i in staff_file()[staff_file()['Role'].isin(input.roles_selected())].index]\n            if 'Unselect all' in input.roles_selected():\n                selected = []\n            return ui.input_checkbox_group(  \n                'staff_selected',  \n                'Staff',  \n                {  \n                    i: i for i in staff_file().index\n                },\n                selected=selected\n            ),\n    \n    @render.ui\n    def ui_unit():\n        return ui.input_text(\n            'unit', 'UoS Code', value=guess_code()\n        ),\n        \n    @render.ui\n    @reactive.event(input.activity)\n    def ui_other_activity():  \n        if input.activity() == 'other_activity':\n            return  ui.input_text(\n                'other_activity', 'Other activity'\n            )\n        \n    @render.ui\n    @reactive.event(input.variation)\n    def ui_other_reason():  \n        if input.variation() == 'other_reason':\n            return  ui.input_text(\n                'other_reason', 'Other variation reason'\n            )\n        \n    @render.ui\n    @reactive.event(input.scheduled)\n    def ui_scheduled_start_time():  \n        if input.scheduled() == 'Y':\n            return ui.input_text(\n                'scheduled_start_time', 'Start time (24-hour HHMM)'\n            )\n        \n    @render.ui\n    @reactive.event(input.scheduled)\n    def ui_scheduled_start_date():  \n        if input.scheduled() == 'Y':\n            return ui.input_date(\n                'scheduled_start_date', 'Start date:', format='dd/mm/yy'\n            )\n        \n    @render.ui\n    @reactive.event(input.scheduled)\n    def ui_scheduled_weeks():  \n        if input.scheduled() == 'Y':\n            return ui.input_text(\n                'scheduled_weeks', 'Weeks'\n            )\n\n    @render.ui\n    @reactive.event(input.scheduled)\n    def ui_flex():  \n        if input.scheduled() == 'N':\n            return ui.input_radio_buttons(  \n                'flex',  \n                'Flex-time',  \n                {'Y': 'Yes', 'N': 'No'},  \n            ),\n        \n    @render.ui\n    @reactive.event(input.flex)\n    def ui_unscheduled_start_date():  \n        if input.flex() == 'N':\n            return ui.input_date(\n                'unscheduled_start_date', 'Start date:', format='dd/mm/yy'\n            ),\n        \n    @render.ui\n    @reactive.event(input.flex)\n    def ui_unscheduled_weeks():  \n        if input.flex() == 'N':\n            return ui.input_text(\n                'unscheduled_weeks', 'Weeks'\n            ),  \n  \n    @render.text\n    def get_date():\n        return input.start_date()\n\n    current_df = reactive.value(base_df)\n    rows_added = reactive.value(0)\n\n    @reactive.effect    \n    @reactive.event(input.add_button)\n    def _():\n        current_df.set(render_df.data_view())\n        to_add = []\n        \n        for name in input.staff_selected():\n\n            phd_stat = staff_file().loc[name, 'PhDStatus']\n\n            if input.role() == 'Coordinator':\n                phd_stat = 'y'\n\n            if input.activity() == 'other_activity':\n                activity = input.other_activity()\n            else:\n                activity = input.activity()\n\n            if input.variation() == 'other_reason':\n                variation = input.other_reason()\n            else:\n                variation = input.variation()\n\n            if input.role() == 'Use prefill':\n                role = staff_file().loc[name, 'Role']\n            else:\n                role = input.role()\n\n            if input.activity() == 'MARKING':\n                code = 'M05'\n            elif input.activity() == 'tut':\n                activity = 'TEACHING (Tutorial)'\n                if role == 'Demonstrator':\n                    code = 'DE2'\n                else:\n                    code = 'TU2'\n            elif input.activity() == 'retut':\n                activity = 'TEACHING (Repeat tutorial)'\n                if role == 'Demonstrator':\n                    code = 'DE2'\n                else:\n                    code = 'TU4'\n            elif input.activity() == 'dem':\n                activity = 'TEACHING (demonstrating)'\n                code = 'DE2'\n            elif input.activity() == 'lec':\n                activity = 'TEACHING (lecture)'\n                code = ''\n            elif input.activity() == 'other_activity':\n                code = ''\n            else:\n                code = 'A02'\n            \n            if phd_stat.lower() == 'y' and len(code) > 1:\n                code = code[:-1] + str(int(code[-1]) - 1)\n\n            if input.scheduled() == 'Y':\n                unscheduled_flex = 'N'\n                unscheduled_start = 'NA'\n                unscheduled_weeks = 'NA'\n                scheduled_start_time = input.scheduled_start_time()\n                scheduled_start = input.scheduled_start_date().strftime('%d %b %Y')\n                scheduled_weeks = input.scheduled_weeks()\n\n            else:\n                scheduled_start_time = ''\n                scheduled_start = ''\n                scheduled_weeks = ''\n                if input.flex() == 'Y':\n                    unscheduled_flex = 'Y'\n                    unscheduled_start = 'NA'\n                    unscheduled_weeks = 'NA'\n                else:\n                    unscheduled_flex = 'N'\n                    unscheduled_start = input.unscheduled_start_date().strftime('%d %b %Y')\n                    unscheduled_weeks = input.unscheduled_weeks()\n                    \n\n            to_add.append((input.unit(), name, activity, role, variation, input.sick_leave(), input.on_campus(), input.units(), code, scheduled_start_time, scheduled_start, scheduled_weeks, unscheduled_flex, unscheduled_start, unscheduled_weeks))\n        \n        previous_df = current_df()\n        to_add_df = pd.DataFrame(to_add, columns=previous_df.columns[1:])\n        to_add_df['Delete'] = [get_delete_button(i) for i in range(rows_added(), rows_added() + to_add_df.shape[0])]\n        to_add_df['RowID'] = [i for i in range(rows_added(), rows_added() + to_add_df.shape[0])]\n        to_add_df.set_index('RowID', inplace=True)\n        to_add_df = to_add_df[previous_df.columns]\n        \n        new_df = pd.concat([previous_df, to_add_df])\n        current_df.set(new_df)\n        rows_added.set(rows_added() + new_df.shape[0])\n\n    @reactive.effect    \n    @reactive.event(input.remove_row)\n    def __():\n        remove_ind = int(input.remove_row())\n        new_df = render_df.data_view().drop(index=remove_ind)\n        current_df.set(new_df)\n\n    @render.data_frame\n    def render_df():\n        if input.add_button():\n            return render.DataGrid(\n                current_df(),\n                editable=True,\n                height=1000,\n            )\n        else:\n            return render.DataGrid(\n                base_df,\n            )\n        \n    @render_df.set_patch_fn\n    def _(*, patch: render.CellPatch) -> render.CellValue:\n        if patch['column_index'] in [7]:\n            return float(patch['value'])\n        return patch['value']\n\n    @render.download(filename=f'ota-{datetime.now().strftime(\"%Y-%m-%d-%H%M%S\")}.xlsx')\n    def download():\n        current_df.set(render_df.data_view())        \n        ota_path = os.path.join(os.path.dirname(__file__), 'base-ota.xlsx')\n        new_path = os.path.join(os.path.dirname(__file__), f'ota-{datetime.now().strftime(\"%Y-%m-%d-%H%M%S\")}.xlsx')\n        shutil.copy(ota_path, new_path)\n        def colour_phd(x, color):\n            return np.where(np.isin(x, (staff_file()[staff_file()['PhDStatus'] == 'Y']).index), f'color: {color};', None)\n        def border(x):\n            return 'border: solid thin'\n        with pd.ExcelWriter(new_path, mode='a', if_sheet_exists='overlay', engine='openpyxl') as writer:\n            current_df().iloc[:, 1:].style.apply(colour_phd, color='red', subset='Staff').applymap(border).to_excel(writer, index=False, header=False, sheet_name='Sheet1', startrow=3)\n        return new_path\n\n    @render.download(filename='UOSCODE-staff-details.csv')\n    def download_template():       \n        path = os.path.join(os.path.dirname(__file__), 'TEST1234-staff-details.csv')\n        return path\n    \napp = App(app_ui, server)\n", "type": "text"}, {"name": "TEST1234-staff-details.csv", "content": "Name,PhDStatus,Role\nAlice,Y,Tutor\nBob,N,Demonstrator\nCharlie,Y,Tutor\nDan,Y,Lecturer\nEve,Y,Coordinator\n", "type": "text"}, {"name": "base-ota.xlsx", "content": "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", "type": "binary"}, {"name": "requirements.txt", "content": "openpyxl\n", "type": "text"}]